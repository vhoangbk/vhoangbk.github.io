<!doctype html><html lang="vi"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Test API</title><style>body{font-family:Arial,sans-serif;max-width:800px;margin:50px auto;padding:20px}.section{margin:20px 0;padding:20px;border:1px solid #ddd;border-radius:8px}h2{color:#333}button{background-color:#4caf50;color:#fff;padding:10px 20px;border:none;border-radius:4px;cursor:pointer;margin:5px}button:hover{background-color:#45a049}.result{margin-top:10px;padding:10px;background-color:#f5f5f5;border-radius:4px;white-space:pre-wrap;font-family:monospace}</style></head><body><h1>Test API Endpoints</h1><div class="section"><h2>1. Test POST Binary Data</h2><button onclick="writeData()">Gửi Binary Data</button> <button onclick="completeWrite()">Thông báo hoàn thành</button><div id="result1" class="result"></div></div><script>async function writeData(){const t=document.getElementById("result1");try{const e=new Uint8Array([1,2,3,4,5,6,7,8,9,10]),n=new FormData;n.append("filename","test-file.mp4"),n.append("action","write"),n.append("data",new Blob([e]),"file.bin");const a=await fetch("/api/save-file",{method:"POST",body:n}),o=await a.text();t.textContent=`Status: ${a.status}\nResponse: ${o}`}catch(e){t.textContent=`Error: ${e.message}`}}async function completeWrite(){const t=document.getElementById("result1");try{const e=new FormData;e.append("filename","test-file.mp4"),e.append("action","complete");const n=await fetch("/api/save-file",{method:"POST",body:e}),a=await n.text();t.textContent=`Status: ${n.status}\nResponse: ${a}`}catch(e){t.textContent=`Error: ${e.message}`}}</script></body></html>- trên client có 2 function (file test-api.html) writeData: gửi binary data đến server completeWrite: thông báo server hoàn thành việc gửi data - trên server (hungnote-index.js) cần handle 2 action 'write' và 'complete' tương ứng với các request từ client. Chú ý closeSync chỉ được gọi khi action là 'complete'.